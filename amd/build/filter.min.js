function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("local_amos/filter",["exports","core/utils","core/str","core/pubsub","./filter_events","./translator_events"],function(a,b,c,d,e,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;d=i(d);e=g(e);f=g(f);function g(a){return a&&a.__esModule?a:{default:a}}function h(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;h=function(){return a};return a}function i(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=h();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function j(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function k(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){j(h,d,e,f,g,"next",a)}function g(a){j(h,d,e,f,g,"throw",a)}f(void 0)})}}var l=new Map,m=[];a.init=function init(){n();o();r();t();v();w()};var n=function(){document.getElementById("amosfilter_fcmp_items_table").querySelectorAll(":scope tr").forEach(function(a,b){var c=a.querySelector("label[for^=\"amosfilter_fcmp_f_\"]"),d="HEADING_"+b;if(c){d=c.innerText.toString().toLowerCase()}l.set(d,a)});m=document.getElementById("amosfilter_flng").querySelectorAll(":scope option")},o=function(){var a=document.getElementById("amosfilter"),c=document.getElementById("amosfilter_fcmp"),e=document.getElementById("amosfilter_fcmp_search"),g=document.getElementById("amosfilter_flng_search"),h=document.getElementById("amosfilter_fver"),i=document.getElementById("amosfilter_flast");a.addEventListener("click",function(b){if(!b.target.hasAttribute("data-action")){return}var d=b.target.getAttribute("data-action"),e=b.target.closest("[data-region]").getAttribute("data-region");if("amosfilter_fcmp"==e){p(b,c,d)}if("amosfilter_buttons"==e&&"togglemoreoptions"==d){u(b,a)}if("amosfilter_buttons"==e&&"submit"==d){b.preventDefault();b.target.blur();document.getElementById("amosfilter_fpg").value=1;x()}});a.addEventListener("change",function(a){if(a.target.id.startsWith("amosfilter_fcmp_")){r()}if("amosfilter_flng"==a.target.id){t()}if("amosfilter_flast"==a.target.id){if(i.checked){h.setAttribute("disabled","disabled")}else{h.removeAttribute("disabled")}}});d.subscribe(f.default.pagechange,function(a){document.getElementById("amosfilter_fpg").value=a;x()});[e,g].forEach(function(a){a.addEventListener("keypress",function(a){if(13==a.keyCode){a.preventDefault();a.stopPropagation()}})});e.addEventListener("input",(0,b.debounce)(function(){q(e)},200));g.addEventListener("input",(0,b.debounce)(function(){s(g)},200))},p=function(a,b,c){document.getElementById("amosfilter_fapp").checked=!1;document.getElementById("amosfilter_fworkplace").checked=!1;if("selectstandard"==c){a.preventDefault();b.querySelectorAll("".concat(":scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]")).forEach(function(a){var b=a.getAttribute("data-component-type");a.checked="core"==b||"standard"==b})}if("selectworkplace"==c||"selectapp"==c){a.preventDefault();var d="";switch(c){case"selectworkplace":d="workplace";break;case"selectapp":d="app";break;}b.querySelectorAll("".concat(":scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]")).forEach(function(a){a.checked=a.hasAttribute("data-component-"+d)});document.getElementById("amosfilter_f"+d).checked=!0;v()}if("selectall"==c){a.preventDefault();b.querySelectorAll("".concat(":scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]")).forEach(function(a){a.checked=!0})}if("selectnone"==c){a.preventDefault();b.querySelectorAll("".concat(":scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]")).forEach(function(a){a.checked=!1})}r()},q=function(a){var b=a.value.toString().replace(/^ +| +$/,"").toLowerCase(),c=document.createElement("tbody");l.forEach(function(a,d){if(d.startsWith("HEADING")){c.appendChild(a);return}if(""==b||-1!==d.indexOf(b)){c.appendChild(a)}});var d=document.getElementById("amosfilter_fcmp_items_table");d.innerHTML="";d.appendChild(c)},r=function(){var a=document.getElementById("amosfilter_fcmp"),b=document.getElementById("amosfilter_fcmp_counter"),c=document.getElementById("amosfilter_fcmp_invalid_feedback"),d=a.querySelectorAll(":scope input[name=\"fcmp[]\"]:checked").length;if(0==d){b.classList.add("badge-danger");a.classList.add("is-invalid");c.classList.remove("hidden")}else{b.classList.remove("badge-danger");a.classList.remove("is-invalid");c.classList.add("hidden")}b.textContent=d},s=function(a){var b=a.value.toString().replace(/^ +| +$/,"").toLowerCase();m.forEach(function(a){if(""==b||-1!==a.text.toString().toLowerCase().indexOf(b)){a.classList.remove("hidden");a.removeAttribute("disabled")}else{a.classList.add("hidden");a.setAttribute("disabled","disabled")}})},t=function(){var a=document.getElementById("amosfilter_flng"),b=document.getElementById("amosfilter_flng_counter"),c=document.getElementById("amosfilter_flng_invalid_feedback"),d=a.querySelectorAll(":scope option:checked").length;if(0==d){b.classList.add("badge-danger");a.classList.add("is-invalid");c.classList.remove("hidden")}else{b.classList.remove("badge-danger");a.classList.remove("is-invalid");c.classList.add("hidden")}b.textContent=d},u=function(){var a=k(regeneratorRuntime.mark(function a(b,d){return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:b.preventDefault();if(!("0"==d.getAttribute("data-level-showadvanced"))){a.next=8;break}d.setAttribute("data-level-showadvanced",1);a.next=5;return(0,c.get_string)("lessfilteringoptions","local_amos");case 5:b.target.innerText=a.sent;a.next=13;break;case 8:d.setAttribute("data-level-showadvanced",0);a.next=11;return(0,c.get_string)("morefilteringoptions","local_amos");case 11:b.target.innerText=a.sent;v();case 13:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),v=function(){var a=document.getElementById("amosfilter");a.querySelectorAll(":scope [data-level=\"advanced\"][data-level-control]").forEach(function(a){var b=document.getElementById(a.getAttribute("data-level-control")),c=!1;if("input"==b.tagName.toLowerCase()&&"checkbox"==b.getAttribute("type")&&b.checked){c=!0}if("input"==b.tagName.toLowerCase()&&"text"==b.getAttribute("type")&&""!==b.value){c=!0}if("select"==b.tagName.toLowerCase()&&b.hasAttribute("data-default")&&!b.hasAttribute("disabled")){var d=b.querySelectorAll(":scope option:checked");if(1!=d.length){c=!0}else{d.forEach(function(a){if(a.value!==b.getAttribute("data-default")){c=!0}})}}if(c){a.setAttribute("data-level-forceshow",1)}else{a.removeAttribute("data-level-forceshow")}});a.querySelectorAll(":scope [data-level=\"advanced\"][data-level-control]").forEach(function(a){var b=document.getElementById(a.getAttribute("data-level-control"));if("fieldset"==b.tagName.toLowerCase()){if(b.querySelector("[data-level-forceshow]")){a.setAttribute("data-level-forceshow",1)}else{a.removeAttribute("data-level-forceshow")}}})},w=function(){var a=document.getElementById("amosfilter_fcmp").querySelector("input[id^=\"amosfilter_fcmp_f_\"]:checked");if(a){a.scrollIntoView(!1)}},x=function(){var a=document.getElementById("amosfilter"),b=document.getElementById("amosfilter_flng"),c=document.getElementById("amosfilter_loading_indicator"),f=document.getElementById("amosfilter_flng_search");c.classList.remove("hidden");b.querySelectorAll(":scope option").forEach(function(a){a.removeAttribute("disabled")});var g=a.querySelector("form"),h=new FormData(g);s(f);h.delete("sesskey");d.publish(e.default.submit,new URLSearchParams(h).toString())}});
//# sourceMappingURL=filter.min.js.map
